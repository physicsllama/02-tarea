\documentclass{article}

\usepackage{amsmath}

\usepackage{lmodern}

\usepackage{graphicx} 

\usepackage[spanish]{babel}

\usepackage{fancyhdr}

\usepackage{subcaption}

\usepackage[margin=1.2in]{geometry} 

\setlength\headheight{10pt} 

\renewcommand{\figurename}{Figura}

\usepackage{booktabs}

\newcommand{\sgn}{\text{sgn}}


\pagestyle{fancy}
\fancyhf{}
\cfoot{\thepage}
\rhead{Nicolás Valdés \\ RUT: 19.247.388-8 \\ FI3104-1 2018B \\ 4/10/18}
\lhead{\includegraphics[scale=0.52]{logo}}



\begin{document}
\thispagestyle{fancy}
\text{} \vspace{0.3cm}
\begin{center}
\LARGE {\bf Tarea 2} 
\end{center}
\normalsize 
\section*{Problema 1}
\subsection*{Introducción} 

La catenaria es una curva de gran importancia en la vida real, dado que representa la forma que toma una cuerda o cadena colgando entre dos puntos fijos. En particular a nosotros nos interesa en este problema porque una compañía nos pide calcular el largo que se requiere para hacer cables para torres de tensión. La ecuación de la catenaria está dada por 
\begin{align}
y(x) = a\cosh\left(\frac{x-x_0}{a}\right),
\end{align}
donde $a$ es un parámetro que vamos a determinar, $x_0$ es el centro de la catenaria, $y$ representa la altura, y $x$ representa la distancia horizontal desde $x=0$. 
\subsection*{Metodología} 
Primero hay que encontrar $a$ dados los datos del problema. 
Escogemos $x_0=0$ por conveniencia. Por el enunciado sabemos que la diferencia de altura entre el punto medio y un extremo es $H =$ 7.5 metros. La distancia horizontal entre estos dos puntos es $L = 10$ metros. Entonces tenemos la ecuación 
\begin{align}
y(L)-y(0) = H \implies F(a) = 0,
\end{align}
donde 
\begin{align}
F(a)\equiv a\cosh\left(\frac{L}{a}\right) - a - H.
\end{align}
Entonces para encontrar $a$, debemos encontrar raíces de la función $F$. Se utiliza el método de la bisección para encontrar dichas raíces por razones discutidas en las conclusiones. Este método consiste en tener un punto inicial $A$ y otro final $B$, $B>A$. La raíz de $F$ debe estar entre $A$ y $B$; esto se aseguró usando un gráfico de $F$ para ver aproximadamente el intervalo donde se encuentra la raíz. Se utilizó $A=7$, $B=8$. 

Se define $m = \frac{1}{2}( A + B)$. Luego se evalúa $F(A)*F(m)$, y $F(B)*F(m)$. Si ninguno ($A$, $B$, o $m$) es la raíz, uno de estos valores debe ser positivo y el otro negativo. Si es negativo significa que la raíz se encuentra entre esos dos valores. Entonces por ejemplo si $F(A)*F(m)<0$, la raíz está en $[A,m]$. Estas posibilidades se evalúan con un {\it if}. Si se cumple $F(A)*F(m)<0$, definimos $B=m$ para un segundo paso de este mismo proceso. Se reitera esto con un {\it while} (aquí se hizo 100 veces). Se devuelve el valor $m$, que es aproximadamente la raíz de $F$. 

Teniendo $a$, se tiene una forma explícita para la curva de la catenaria. Se toma una derivada de la función usando scipy, luego se define la función $\sqrt{1+y'(x)^2}$, la cual se integra con scipy para determinar el largo de la curva. 



\subsection*{Resultados} 

El valor de $a$ encontrado fue  aproximadamente 7.67 m, y el largo $\ell$ necesario para la cuerda es 26.20 m. Más precisamente, 
\begin{align}
a &\simeq  \text{7.667012405668327 m} \\
\ell &\simeq \text{26.20190045304408 m}
\end{align}

En la Figura 1 se encuentra un gráfico que muestra dónde se ubica el cero de $F(a)$. 

\begin{figure}[ht!]
\centering
\includegraphics[width=4in]{ejemplo2}
\caption{Cero de $F(a)$}
\end{figure}

\subsection*{Conclusiones} 
Viendo el gráfico que hicimos de $F(a)$ en la Figura 2, está claro que el método de Newton no se debe usar. Se ve, primero, que diverge la función en $a=0$, lo cuál podría causar problemas. Además, la derivada de la función es un número muy pequeño en la zona donde parece haber una raíz de la función. Dadas estas dos cosas, lo mejor parece ser utilizar el método de la bisección, comenzando con dos números positivos para evitar una posible raíz en el lado negativo, y para evitar la divergencia de $F$. 

\begin{figure}[ht!]
\centering
\includegraphics[width=4in]{ejemplo}
\caption{Gráfico de $F(a)$}
\end{figure}

Entonces a pesar de que la convergencia del método de Newton es más rápida que la del método de la bisección, en este caso el método de la bisección es más seguro. Notamos que el resultado para $\ell$ tiene sentido, ya que el mínimo largo debe ser 20 metros, lo cual corresponde a una cuerda totalmente tensa entre las dos torres. Como la cuerda cuelga una cierta cantidad, el largo de aproximadamente 26 metros es razonable. 


%plot catenary? 



\section*{Problema 2}

\subsection*{Introducción} 

%problema de encontrar ceros de funciones multivaluadas en general, ceros simultaneos 

Las funciones de interés en este problema son 
\begin{align}
F_1(x,y) &= x^4+y^4 - 15 \\
F_2(x,y)&= x^3y-xy^3-y/2 -1.388
\end{align}
Buscamos sus ceros simultáneos. La estrategia es graficar las funciones, y notar que una tiene ceros en una curva cerrada. Luego se encuentran los ceros de la otra función a lo largo de esta curva usando el método de la bisección. 
\subsection*{Metodología} 

Como indica el enunciado y como se ve en la Figura \ref{ceros}, el nivel cero de la función $F_1$ es una curva cerrada. Entonces para encontrar los ceros simultáneos de las funciones, basta con recorrer esta curva y ver en qué puntos $F_2$ se hace cero. Una forma paramétrica de expresar la curva $F_1(x,y)=0$ es 
\begin{align}
x(t) &= \sgn(\sin(t))\sqrt[4]{15\sin^2(t))}\\
y(t) &= \sgn(\cos(t)) \sqrt[4]{15\cos^2(t)},
\end{align}
donde el $x(t)$ está indicado en el enunciado, y el $y(t)$ se puede deducir por la identidad trigonométrica fundamental. El factor de $\sqrt[4]{15}$ es para cancelar el $-15$ al final de la función. Se puede verificar fácilmente entonces que al reemplazar esta curva en $F_1(x,y)$, se obtiene 0. Aquí el parámetro $t\in [0,2\pi]$. 

Entonces la idea es reemplazar estos valores de $x(t)$, $y(t)$ en $F_2(x,y)$, para evaluar la función solamente en la curva para la cual $F_1$ es cero. Al encontrar los $t$ donde se anula $F_2$, podemos reemplazar éstos en $x(t)$, $y(t)$ para tener los puntos explícitos. 

Usamos el método de la bisección para hacer esto. Notamos de la Figura \ref{ceros} que hay 8 ceros relevantes, entonces hay que tener cuidado con los valores iniciales $a$ y $b$ en la búsqueda de ceros. La forma de escoger estos valores se basó en el análisis cualitativo de la Figura 3. La idea fue analizar entre $t_1=0$, y $t_2=\pi/4+0.5$ para el primer cero en la esquina superior derecha. Para el segundo cero, entre $t_2$  y $t_3 = \pi/2+0.5$. Así sucesivamente se encontraron los valores de $a$ y $b$ razonables para cada cero de la función $F_2$. 

\subsection*{Resultados} 

En la Tabla 1 se encuentran las coordenadas $(x,y)$ de las distintas raíces simultáneas de $F_1$ y $F_2$. Se colocan con solo 3 decimales de precisión; para mayor precisión se pueden ver los resultados del código. Se adjunta en la Figura 4 un gráfico de contorno de las funciones porque es bonito. 

\begin{figure}[ht!]
\centering
\includegraphics[width=4in]{zeros1} 
\caption{Ceros de $F_1(x,y)$ y $F_2(x,y)$} \label{ceros}
\end{figure}

\begin{figure}[ht!]
\centering
\includegraphics[width=4in]{zeros2}
\caption{Gráfico de Contorno de las Funciones}
\end{figure}

\begin{table}[ht!]
\centering
\begin{tabular}{ccc}
 Raíz &$x$  &$y$  \\ 
 \hline \hline 
  1 & 1.76 & 1.52 \\
  2 & 1.97 & 0.20 \\
  3 & 1.62 & $-$1.68 \\
  4 & 0.05 & $-$1.97 \\
  5 & $-$1.69 & $-$1.62 \\
  6 & $-$1.97 & $-$0.17 \\
  7 & $-$1.51 & 1.77 \\
  8 & $-$0.32 & 1.97 \\
  \bottomrule
\end{tabular}
\end{table}

\newpage

\subsection*{Conclusiones} 

Es importante destacar la importancia de graficar problemas antes de resolverlos, para adquirir un conocimiento cualitativo sobre su comportamiento. Muchas veces, como en esta ocasión, se puede llegar a la solución de un problema complejo, usando métodos conocidos para problemas más simples. La idea para hacer esto se encontró por la estructura gráfica del problema. 

Se usó el método de la bisección porque el gráfico de $F_2(t)$ se asemeja a una función sinusoidal. Estas funciones son complicadas con el método de Newton, porque uno se puede saltar entre distintos ceros y no conseguir el buscado. Con el método de bisección es más fácil estar seguro del intervalo al cual pertenece el cero buscado. 


\newpage
\section*{Mensaje Secreto} 
{\it
``In the beginning the Universe was created. This has made a lot of
people very angry and been widely regarded as a bad move.''}

\hfill-- Douglas Adams.\\
Esto lo encontré en GitHub Desktop, metiéndome a History y buscando en los distintos commits si había un mensaje secreto. 





\end{document} 